<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>İlişki Analizi</title>

  <style>
    :root{
      --purple-900:#2a103a;
      --purple-800:#3b1554;
      --purple-700:#4b1d6a;
      --purple-200:#e9d8ff;

      --gold-600:#d4af37;
      --gold-500:#f1c84c;

      --text:#f6f1ff;
      --muted:#d9c7ee;

      --card:#2f1244;
      --card-2:#351651;

      --border: rgba(241, 200, 76, 0.35);
      --shadow: 0 14px 40px rgba(0,0,0,0.35);
    }

    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      color: var(--text);
      background:
        radial-gradient(900px 450px at 20% 10%, rgba(241,200,76,0.18), transparent 60%),
        radial-gradient(900px 450px at 80% 0%, rgba(233,216,255,0.16), transparent 55%),
        linear-gradient(135deg, var(--purple-900), var(--purple-700));
      min-height: 100vh;
    }

    .container {
      background: linear-gradient(180deg, var(--card), var(--card-2));
      padding: 22px;
      border-radius: 14px;
      box-shadow: var(--shadow);
      max-width: 666px;
      margin: auto;
      border: 1px solid rgba(241,200,76,0.18);
      backdrop-filter: blur(6px);
    }

    .brand {
      display: flex;
      justify-content: center;
      margin: 4px 0 10px 0;
    }
    .brand img {
      width: 120px;
      max-width: 45%;
      height: auto;
      border-radius: 12px;
      box-shadow: 0 10px 22px rgba(0,0,0,0.25);
      border: 1px solid rgba(241,200,76,0.18);
    }

    h2 {
      text-align: center;
      margin: 0 0 8px 0;
      color: var(--gold-500);
      letter-spacing: 0.3px;
      text-shadow: 0 1px 0 rgba(0,0,0,0.35);
    }

    .subtitle{
      text-align:center;
      margin: 0 0 16px 0;
      color: rgba(217,199,238,0.92);
      font-size: 13px;
      line-height: 1.35;
    }

    .input-group { margin-bottom: 14px; }

    .input-group label {
      font-size: 13px;
      color: var(--muted);
    }

    .input-group input {
      width: 100%;
      padding: 11px 10px;
      margin-top: 6px;
      border: 1px solid rgba(233,216,255,0.25);
      border-radius: 10px;
      background: rgba(255,255,255,0.06);
      color: var(--text);
      outline: none;
      transition: border-color .15s ease, box-shadow .15s ease;
    }

    .input-group input:focus{
      border-color: var(--border);
      box-shadow: 0 0 0 4px rgba(241,200,76,0.12);
    }

    .btn-container {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      margin-top: 6px;
    }

    .btn {
      width: 48%;
      padding: 11px 10px;
      border: none;
      border-radius: 10px;
      font-size: 15px;
      cursor: pointer;
      transition: transform .08s ease, filter .12s ease, box-shadow .12s ease;
      box-shadow: 0 10px 22px rgba(0,0,0,0.25);
    }

    .btn-green {
      background: linear-gradient(180deg, var(--gold-500), var(--gold-600));
      color: #2a103a;
      font-weight: bold;
    }
    .btn-green:hover { filter: brightness(1.03); }
    .btn-green:active { transform: translateY(1px); }

    .btn-gray {
      background: linear-gradient(180deg, rgba(233,216,255,0.22), rgba(233,216,255,0.12));
      color: var(--text);
      border: 1px solid rgba(233,216,255,0.25);
      box-shadow: 0 10px 22px rgba(0,0,0,0.18);
    }
    .btn-gray:hover { filter: brightness(1.05); }
    .btn-gray:active { transform: translateY(1px); }

    .output {
      margin-top: 18px;
      font-size: 15px;
      text-align: center;
      color: var(--text);
      padding: 14px 12px;
      border-radius: 12px;
      background:
        radial-gradient(500px 220px at 15% 0%, rgba(241,200,76,0.16), transparent 55%),
        linear-gradient(180deg, rgba(233,216,255,0.12), rgba(255,255,255,0.06));
      border: 1px solid rgba(241,200,76,0.22);
    }

    /* --- üst metin hiyerarşisi --- */
    .result-top{
      display: flex;
      flex-direction: column;
      gap: 8px;
      align-items: center;
      margin-bottom: 10px;
    }
    .pill{
      display:inline-block;
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid rgba(233,216,255,0.20);
      background: rgba(233,216,255,0.10);
      font-size: 13px;
      font-weight: 700;
      color: rgba(246,241,255,0.98);
    }
    .score{
      font-size: 18px;
      font-weight: 900;
      color: var(--gold-500);
      text-shadow: 0 1px 0 rgba(0,0,0,0.35);
    }

    /* --- insani yorum kartı --- */
    .human-card{
      margin-top: 12px;
      padding: 14px 14px;
      border-radius: 12px;
      background: linear-gradient(180deg, rgba(241,200,76,0.12), rgba(255,255,255,0.05));
      border: 1px solid rgba(241,200,76,0.22);
      text-align: left;
      line-height: 1.55;
    }
    .human-card .h-title{
      font-weight: 900;
      color: var(--gold-500);
      font-size: 16px;
      margin-bottom: 6px;
    }
    .human-card .h-sub{
      color: rgba(217,199,238,0.95);
      font-size: 13px;
      margin-top: 8px;
    }
    .badge{
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 800;
      border: 1px solid rgba(233,216,255,0.22);
      background: rgba(233,216,255,0.10);
      margin-left: 6px;
    }
    .today-move{
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px dashed rgba(241,200,76,0.35);
      font-weight: 800;
    }

    /* --- breakdown satırı --- */
    .breakdown{
      margin-top: 10px;
      font-size: 13px;
      color: rgba(217,199,238,0.95);
    }
    .breakdown b{ color: rgba(246,241,255,0.98); }

    /* --- kapanış CTA --- */
    #kapanis.output{
      margin-top: 12px;
      padding: 18px 16px !important;
      font-size: 16px;
      line-height: 1.55;
      background:
        radial-gradient(500px 220px at 85% 0%, rgba(241,200,76,0.16), transparent 55%),
        linear-gradient(180deg, rgba(233,216,255,0.10), rgba(255,255,255,0.05));
    }

    #kapanis.output b{
      display: inline-block;
      font-size: 20px;
      margin-bottom: 8px;
    }

    .ig-link{
      color: var(--gold-500);
      text-decoration: none;
      font-weight: 900;
      border-bottom: 1px dashed rgba(241,200,76,0.65);
      padding-bottom: 1px;
    }

    #kapanis.output a.ig-link{
      display: inline-block;
      margin-top: 10px;
      padding: 10px 14px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 900;
      background: rgba(241, 200, 76, 0.16);
      border: 1px solid rgba(241, 200, 76, 0.55);
      text-decoration: none;
      border-bottom: none;
    }

    #kapanis.output a.ig-link:hover{
      filter: brightness(1.06);
      transform: translateY(-1px);
    }
  </style>
</head>

<body>
  <div class="container">

    <div class="brand">
      <img src="logo.png" alt="Numerolog Simurg Logo">
    </div>

    <h2>Numerolojik Olarak Sevgilinle % Kaç Uyumlusunuz?</h2>

    <div class="subtitle">
      Bu sonuç genel bir uyum değerlendirmesidir. Detaylı analizi birlikte yapabiliriz.
    </div>

    <div class="input-group">
      <label for="person1Name">Birinci Kişi: Adı Soyadı</label>
      <input type="text" id="person1Name" placeholder="Adı Soyadı" oninput="convertInputToEnglish(this)">
    </div>

    <div class="input-group">
      <label for="person1DOB">Birinci Kişi: Doğum Tarihi</label>
      <input type="date" id="person1DOB">
    </div>

    <div class="input-group">
      <label for="person2Name">İkinci Kişi: Adı Soyadı</label>
      <input type="text" id="person2Name" placeholder="Adı Soyadı" oninput="convertInputToEnglish(this)">
    </div>

    <div class="input-group">
      <label for="person2DOB">İkinci Kişi: Doğum Tarihi</label>
      <input type="date" id="person2DOB">
    </div>

    <div class="btn-container">
      <button class="btn btn-green" onclick="startAnalysis()">Uyum Puanını Gör</button>
      <button class="btn btn-gray" onclick="resetForm()">Reset</button>
    </div>

    <div id="output" class="output" style="display:none;"></div>
    <div id="kapanis" class="output" style="display:none;"></div>

  </div>

  <script>
    function resetForm() {
      document.getElementById('person1Name').value = '';
      document.getElementById('person1DOB').value = '';
      document.getElementById('person2Name').value = '';
      document.getElementById('person2DOB').value = '';

      const out = document.getElementById('output');
      out.innerHTML = '';
      out.style.display = 'none';

      const kapanis = document.getElementById('kapanis');
      kapanis.innerHTML = '';
      kapanis.style.display = 'none';
    }

    function convertInputToEnglish(input) {
      let value = input.value;
      const turkishChars = {
        'ç': 'c', 'ğ': 'g', 'ı': 'i', 'İ': 'I', 'ö': 'o', 'ş': 's', 'ü': 'u',
        'Ç': 'C', 'Ğ': 'G', 'Ö': 'O', 'Ş': 'S', 'Ü': 'U'
      };
      for (let char in turkishChars) {
        const regex = new RegExp(char, 'g');
        value = value.replace(regex, turkishChars[char]);
      }
      input.value = value;
    }

    const letterToNumber = {
      'A': 1, 'a': 1, 'J': 1, 'j': 1, 'S': 1, 's': 1, 'Ş': 1, 'ş': 1,
      'B': 2, 'b': 2, 'K': 2, 'k': 2, 'T': 2, 't': 2, 'C': 3, 'c': 3,
      'Ç': 3, 'ç': 3, 'L': 3, 'l': 3, 'U': 3, 'u': 3, 'Ü': 3, 'ü': 3,
      'D': 4, 'd': 4, 'M': 4, 'm': 4, 'V': 4, 'v': 4, 'E': 5, 'e': 5,
      'N': 5, 'n': 5, 'W': 5, 'w': 5, 'F': 6, 'f': 6, 'O': 6, 'o': 6,
      'Ö': 6, 'ö': 6, 'X': 6, 'x': 6, 'G': 7, 'g': 7, 'Ğ': 7, 'ğ': 7,
      'P': 7, 'p': 7, 'Y': 7, 'y': 7, 'H': 8, 'h': 8, 'Q': 8, 'q': 8,
      'Z': 8, 'z': 8, 'İ': 9, 'i': 9, 'I': 9, 'ı': 9, 'R': 9, 'r': 9
    };

    function calculateNameNumber(name) {
      let sum = 0;
      for (let i = 0; i < name.length; i++) {
        let letter = name[i];
        if (letterToNumber[letter] !== undefined) sum += letterToNumber[letter];
      }
      while (sum >= 10) sum = sum.toString().split('').reduce((acc, num) => acc + parseInt(num), 0);
      return sum;
    }

    function calculateBirthdayNumber(date) {
      const day = date.split('-')[2];
      let sum = day.split('').reduce((acc, num) => acc + parseInt(num), 0);
      while (sum >= 10) sum = sum.toString().split('').reduce((acc, num) => acc + parseInt(num), 0);
      return sum;
    }

    function calculateAcquisitionNumber(date) {
      const dayMonth = date.split('-').slice(1, 3).join('');
      let sum = dayMonth.split('').reduce((acc, num) => acc + parseInt(num), 0);
      while (sum >= 10) sum = sum.toString().split('').reduce((acc, num) => acc + parseInt(num), 0);
      return sum;
    }

    function calculateLifeCode(date) {
      const numbers = date.replace(/[^0-9]/g, '').split('');
      let sum = numbers.reduce((acc, num) => acc + parseInt(num), 0);
      while (sum >= 10) sum = sum.toString().split('').reduce((acc, num) => acc + parseInt(num), 0);
      return sum;
    }

    function calculateVisiblePersonalityNumber(name) {
      const vowels = ['A', 'a', 'E', 'e', 'I', 'i', 'İ', 'ı', 'O', 'o', 'Ö', 'ö', 'U', 'u', 'Ü', 'ü'];
      let consonantSum = 0;
      for (let i = 0; i < name.length; i++) {
        let letter = name[i];
        if (!vowels.includes(letter)) consonantSum += letterToNumber[letter] || 0;
      }
      while (consonantSum >= 10) consonantSum = consonantSum.toString().split('').reduce((acc, num) => acc + parseInt(num), 0);
      return consonantSum;
    }

    function calculateSoulNumber(name) {
      const vowels = ['A', 'a', 'E', 'e', 'I', 'i', 'İ', 'ı', 'O', 'o', 'Ö', 'ö', 'U', 'u', 'Ü', 'ü'];
      let sum = 0;
      for (let i = 0; i < name.length; i++) {
        let letter = name[i];
        if (vowels.includes(letter)) sum += letterToNumber[letter] || 0;
      }
      while (sum >= 10) sum = sum.toString().split('').reduce((acc, num) => acc + parseInt(num), 0);
      return sum;
    }

    function isIn(val, arr) { return arr.indexOf(val) !== -1; }

    /* ====== SKOR HESAPLAMA FONKSİYONLARI (DEĞİŞMEDİ) ====== */
    function calculateYasamScore(person1LifeCode, person2LifeCode) {
      let score = 0;
      if (
        (person1LifeCode === 1 && isIn(person2LifeCode, [1,5,7])) ||
        (person1LifeCode === 2 && isIn(person2LifeCode, [2,4,8])) ||
        (person1LifeCode === 3 && isIn(person2LifeCode, [3,6,9])) ||
        (person1LifeCode === 4 && isIn(person2LifeCode, [2,4,8])) ||
        (person1LifeCode === 5 && isIn(person2LifeCode, [1,5,7])) ||
        (person1LifeCode === 6 && isIn(person2LifeCode, [3,6,9])) ||
        (person1LifeCode === 7 && isIn(person2LifeCode, [1,5,7])) ||
        (person1LifeCode === 8 && isIn(person2LifeCode, [2,4,8])) ||
        (person1LifeCode === 9 && isIn(person2LifeCode, [3,6,9]))
      ) score = 25;
      else if (
        (person1LifeCode === 1 && isIn(person2LifeCode, [2,3,9])) ||
        (person1LifeCode === 2 && isIn(person2LifeCode, [1,3,6,9])) ||
        (person1LifeCode === 3 && isIn(person2LifeCode, [1,2,5])) ||
        (person1LifeCode === 4 && isIn(person2LifeCode, [6,7])) ||
        (person1LifeCode === 5 && isIn(person2LifeCode, [3,9])) ||
        (person1LifeCode === 6 && isIn(person2LifeCode, [2,4,8])) ||
        (person1LifeCode === 7 && isIn(person2LifeCode, [4])) ||
        (person1LifeCode === 8 && isIn(person2LifeCode, [6])) ||
        (person1LifeCode === 9 && isIn(person2LifeCode, [1,2,5,9]))
      ) score = 15;
      else if (
        (person1LifeCode === 1 && isIn(person2LifeCode, [4,6])) ||
        (person1LifeCode === 2 && isIn(person2LifeCode, [5,7])) ||
        (person1LifeCode === 3 && isIn(person2LifeCode, [4,7,8])) ||
        (person1LifeCode === 4 && isIn(person2LifeCode, [1,3,5,9])) ||
        (person1LifeCode === 5 && isIn(person2LifeCode, [2,4,6])) ||
        (person1LifeCode === 6 && isIn(person2LifeCode, [1,5,7])) ||
        (person1LifeCode === 7 && isIn(person2LifeCode, [2,3,6,8,9])) ||
        (person1LifeCode === 8 && isIn(person2LifeCode, [3,7,9])) ||
        (person1LifeCode === 9 && isIn(person2LifeCode, [4,7,8]))
      ) score = 0;
      else if (
        (person1LifeCode === 1 && person2LifeCode === 8) ||
        (person1LifeCode === 5 && person2LifeCode === 8) ||
        (person1LifeCode === 6 && isIn(person2LifeCode, [1,5]))
      ) score = 10;
      else score = 0;
      return score;
    }

    function calculateEdinimScore(person1Acq, person2Acq) {
      let score = 0;
      if (
        (person1Acq === 1 && isIn(person2Acq, [1,5,7])) ||
        (person1Acq === 2 && isIn(person2Acq, [2,4,8])) ||
        (person1Acq === 3 && isIn(person2Acq, [3,6,9])) ||
        (person1Acq === 4 && isIn(person2Acq, [2,4,8])) ||
        (person1Acq === 5 && isIn(person2Acq, [1,5,7])) ||
        (person1Acq === 6 && isIn(person2Acq, [3,6,9])) ||
        (person1Acq === 7 && isIn(person2Acq, [1,5,7])) ||
        (person1Acq === 8 && isIn(person2Acq, [2,4,8])) ||
        (person1Acq === 9 && isIn(person2Acq, [3,6,9]))
      ) score = 15;
      else if (
        (person1Acq === 1 && isIn(person2Acq, [2,3,9])) ||
        (person1Acq === 2 && isIn(person2Acq, [1,3,6,9])) ||
        (person1Acq === 3 && isIn(person2Acq, [1,2,5])) ||
        (person1Acq === 4 && isIn(person2Acq, [6,7])) ||
        (person1Acq === 5 && isIn(person2Acq, [3,9])) ||
        (person1Acq === 6 && isIn(person2Acq, [2,4,8])) ||
        (person1Acq === 7 && isIn(person2Acq, [4])) ||
        (person1Acq === 8 && isIn(person2Acq, [6])) ||
        (person1Acq === 9 && isIn(person2Acq, [1,2,5,9]))
      ) score = 10;
      else if (
        (person1Acq === 1 && isIn(person2Acq, [4,6])) ||
        (person1Acq === 2 && isIn(person2Acq, [5,7])) ||
        (person1Acq === 3 && isIn(person2Acq, [4,7,8])) ||
        (person1Acq === 4 && isIn(person2Acq, [1,3,5,9])) ||
        (person1Acq === 5 && isIn(person2Acq, [2,4,6])) ||
        (person1Acq === 6 && isIn(person2Acq, [1,5,7])) ||
        (person1Acq === 7 && isIn(person2Acq, [2,3,6,8,9])) ||
        (person1Acq === 8 && isIn(person2Acq, [3,7,9])) ||
        (person1Acq === 9 && isIn(person2Acq, [4,7,8]))
      ) score = 0;
      else if (
        (person1Acq === 1 && person2Acq === 8) ||
        (person1Acq === 5 && person2Acq === 8) ||
        (person1Acq === 6 && isIn(person2Acq, [1,5]))
      ) score = 5;
      else score = 0;

      return score;
    }

    function calculateDogumScore(p1B, p2B) {
      let score = 0;
      if (
        (p1B === 1 && isIn(p2B, [1,5,7])) ||
        (p1B === 2 && isIn(p2B, [2,4,8])) ||
        (p1B === 3 && isIn(p2B, [3,6,9])) ||
        (p1B === 4 && isIn(p2B, [2,4,8])) ||
        (p1B === 5 && isIn(p2B, [1,5,7])) ||
        (p1B === 6 && isIn(p2B, [3,6,9])) ||
        (p1B === 7 && isIn(p2B, [1,5,7])) ||
        (p1B === 8 && isIn(p2B, [2,4,8])) ||
        (p1B === 9 && isIn(p2B, [3,6,9]))
      ) score = 15;
      else if (
        (p1B === 1 && isIn(p2B, [2,3,9])) ||
        (p1B === 2 && isIn(p2B, [1,3,6,9])) ||
        (p1B === 3 && isIn(p2B, [1,2,5])) ||
        (p1B === 4 && isIn(p2B, [6,7])) ||
        (p1B === 5 && isIn(p2B, [3,9])) ||
        (p1B === 6 && isIn(p2B, [2,4,8])) ||
        (p1B === 7 && isIn(p2B, [4])) ||
        (p1B === 8 && isIn(p2B, [6])) ||
        (p1B === 9 && isIn(p2B, [1,2,5,9]))
      ) score = 10;
      else if (
        (p1B === 1 && isIn(p2B, [4,6])) ||
        (p1B === 2 && isIn(p2B, [5,7])) ||
        (p1B === 3 && isIn(p2B, [4,7,8])) ||
        (p1B === 4 && isIn(p2B, [1,3,5,9])) ||
        (p1B === 5 && isIn(p2B, [2,4,6])) ||
        (p1B === 6 && isIn(p2B, [1,5,7])) ||
        (p1B === 7 && isIn(p2B, [2,3,6,8,9])) ||
        (p1B === 8 && isIn(p2B, [3,7,9])) ||
        (p1B === 9 && isIn(p2B, [4,7,8]))
      ) score = 0;
      else if (
        (p1B === 1 && p2B === 8) ||
        (p1B === 5 && p2B === 8) ||
        (p1B === 6 && isIn(p2B, [1,5]))
      ) score = 5;
      else score = 0;
      return score;
    }

    function calculateRuhScore(p1S, p2S) {
      let score = 0;
      if (
        (p1S === 1 && isIn(p2S, [1,5,7])) ||
        (p1S === 2 && isIn(p2S, [2,4,8])) ||
        (p1S === 3 && isIn(p2S, [3,6,9])) ||
        (p1S === 4 && isIn(p2S, [2,4,8])) ||
        (p1S === 5 && isIn(p2S, [1,5,7])) ||
        (p1S === 6 && isIn(p2S, [3,6,9])) ||
        (p1S === 7 && isIn(p2S, [1,5,7])) ||
        (p1S === 8 && isIn(p2S, [2,4,8])) ||
        (p1S === 9 && isIn(p2S, [3,6,9]))
      ) score = 15;
      else if (
        (p1S === 1 && isIn(p2S, [2,3,9])) ||
        (p1S === 2 && isIn(p2S, [1,3,6,9])) ||
        (p1S === 3 && isIn(p2S, [1,2,5])) ||
        (p1S === 4 && isIn(p2S, [6,7])) ||
        (p1S === 5 && isIn(p2S, [3,9])) ||
        (p1S === 6 && isIn(p2S, [2,4,8])) ||
        (p1S === 7 && isIn(p2S, [4])) ||
        (p1S === 8 && isIn(p2S, [6])) ||
        (p1S === 9 && isIn(p2S, [1,2,5,9]))
      ) score = 10;
      else if (
        (p1S === 1 && isIn(p2S, [4,6])) ||
        (p1S === 2 && isIn(p2S, [5,7])) ||
        (p1S === 3 && isIn(p2S, [4,7,8])) ||
        (p1S === 4 && isIn(p2S, [1,3,5,9])) ||
        (p1S === 5 && isIn(p2S, [2,4,6])) ||
        (p1S === 6 && isIn(p2S, [1,5,7])) ||
        (p1S === 7 && isIn(p2S, [2,3,6,8,9])) ||
        (p1S === 8 && isIn(p2S, [3,7,9])) ||
        (p1S === 9 && isIn(p2S, [4,7,8]))
      ) score = 0;
      else if (
        (p1S === 1 && p2S === 8) ||
        (p1S === 5 && p2S === 8) ||
        (p1S === 6 && isIn(p2S, [1,5]))
      ) score = 5;
      else score = 0;
      return score;
    }

    function calculateGorunurScore(p1V, p2V) {
      let score = 0;
      if (
        (p1V === 1 && isIn(p2V, [1,5,7])) ||
        (p1V === 2 && isIn(p2V, [2,4,8])) ||
        (p1V === 3 && isIn(p2V, [3,6,9])) ||
        (p1V === 4 && isIn(p2V, [2,4,8])) ||
        (p1V === 5 && isIn(p2V, [1,5,7])) ||
        (p1V === 6 && isIn(p2V, [3,6,9])) ||
        (p1V === 7 && isIn(p2V, [1,5,7])) ||
        (p1V === 8 && isIn(p2V, [2,4,8])) ||
        (p1V === 9 && isIn(p2V, [3,6,9]))
      ) score = 15;
      else if (
        (p1V === 1 && isIn(p2V, [2,3,9])) ||
        (p1V === 2 && isIn(p2V, [1,3,6,9])) ||
        (p1V === 3 && isIn(p2V, [1,2,5])) ||
        (p1V === 4 && isIn(p2V, [6,7])) ||
        (p1V === 5 && isIn(p2V, [3,9])) ||
        (p1V === 6 && isIn(p2V, [2,4,8])) ||
        (p1V === 7 && isIn(p2V, [4])) ||
        (p1V === 8 && isIn(p2V, [6])) ||
        (p1V === 9 && isIn(p2V, [1,2,5,9]))
      ) score = 10;
      else if (
        (p1V === 1 && isIn(p2V, [4,6])) ||
        (p1V === 2 && isIn(p2V, [5,7])) ||
        (p1V === 3 && isIn(p2V, [4,7,8])) ||
        (p1V === 4 && isIn(p2V, [1,3,5,9])) ||
        (p1V === 5 && isIn(p2V, [2,4,6])) ||
        (p1V === 6 && isIn(p2V, [1,5,7])) ||
        (p1V === 7 && isIn(p2V, [2,3,6,8,9])) ||
        (p1V === 8 && isIn(p2V, [3,7,9])) ||
        (p1V === 9 && isIn(p2V, [4,7,8]))
      ) score = 0;
      else if (
        (p1V === 1 && p2V === 8) ||
        (p1V === 5 && p2V === 8) ||
        (p1V === 6 && isIn(p2V, [1,5]))
      ) score = 5;
      else score = 0;
      return score;
    }

    function calculateIsimScore(p1N, p2N) {
      let score = 0;
      if (
        (p1N === 1 && isIn(p2N, [1,5,7])) ||
        (p1N === 2 && isIn(p2N, [2,4,8])) ||
        (p1N === 3 && isIn(p2N, [3,6,9])) ||
        (p1N === 4 && isIn(p2N, [2,4,8])) ||
        (p1N === 5 && isIn(p2N, [1,5,7])) ||
        (p1N === 6 && isIn(p2N, [3,6,9])) ||
        (p1N === 7 && isIn(p2N, [1,5,7])) ||
        (p1N === 8 && isIn(p2N, [2,4,8])) ||
        (p1N === 9 && isIn(p2N, [3,6,9]))
      ) score = 15;
      else if (
        (p1N === 1 && isIn(p2N, [2,3,9])) ||
        (p1N === 2 && isIn(p2N, [1,3,6,9])) ||
        (p1N === 3 && isIn(p2N, [1,2,5])) ||
        (p1N === 4 && isIn(p2N, [6,7])) ||
        (p1N === 5 && isIn(p2N, [3,9])) ||
        (p1N === 6 && isIn(p2N, [2,4,8])) ||
        (p1N === 7 && isIn(p2N, [4])) ||
        (p1N === 8 && isIn(p2N, [6])) ||
        (p1N === 9 && isIn(p2N, [1,2,5,9]))
      ) score = 10;
      else if (
        (p1N === 1 && isIn(p2N, [4,6])) ||
        (p1N === 2 && isIn(p2N, [5,7])) ||
        (p1N === 3 && isIn(p2N, [4,7,8])) ||
        (p1N === 4 && isIn(p2N, [1,3,5,9])) ||
        (p1N === 5 && isIn(p2N, [2,4,6])) ||
        (p1N === 6 && isIn(p2N, [1,5,7])) ||
        (p1N === 7 && isIn(p2N, [2,3,6,8,9])) ||
        (p1N === 8 && isIn(p2N, [3,7,9])) ||
        (p1N === 9 && isIn(p2N, [4,7,8]))
      ) score = 0;
      else if (
        (p1N === 1 && p2N === 8) ||
        (p1N === 5 && p2N === 8) ||
        (p1N === 6 && isIn(p2N, [1,5]))
      ) score = 5;
      else score = 0;
      return score;
    }

    /* ====== sadece metin / çıktı katmanı ====== */
    function getIliskiYorumu(iliskiPuani) {
      if (iliskiPuani < 40) return "Mücadele";
      if (iliskiPuani < 60) return "Değişken";
      if (iliskiPuani < 85) return "Uyumlu";
      return "Ruh Eşi";
    }

    function getBand(iliskiPuani){
      if (iliskiPuani < 40) return "mucadele";
      if (iliskiPuani < 60) return "degisken";
      if (iliskiPuani < 85) return "uyumlu";
      return "ruh_esi";
    }

    function buildHumanInsight({ iliskiPuani, Yasam, Edinim, Dogum, Ruh, Gorunur, Isim, p1Name, p2Name }) {
      const band = getBand(iliskiPuani);
      const label = getIliskiYorumu(iliskiPuani);

      const parts = [
        { val: Yasam,   name: "Yaşam Kodları" },
        { val: Edinim,  name: "Edinim" },
        { val: Dogum,   name: "Doğum" },
        { val: Ruh,     name: "Ruh" },
        { val: Gorunur, name: "Görünür Kişilik" },
        { val: Isim,    name: "İsim" },
      ].sort((a,b) => b.val - a.val);

      const strongest = parts[0];
      const weakest = parts[parts.length - 1];

      let title = "";
      let one = "", two = "", three = "";
      let scale = "";
      let todayMove = "";

      if (band === "mucadele") {
        title = "Zorlayıcı ama öğretici bir bağ.";
        one = "Bu ilişki kendiliğinden akmaktan çok, bilinçli emek ister.";
        two = `Sizi taşıyan taraf <b>${strongest.name}</b>; en çok zorlayan taraf <b>${weakest.name}</b> görünüyor.`;
        three = "Doğru iletişim kurulmazsa aynı döngü tekrar edebilir; kurulursa hızla olgunlaşır.";
        scale = "Bu aralık genelde “zorlayıcı/öğretici” dinamiğe işaret eder.";
        todayMove = "Tartışma anında 10 dakika ara verip sonra “ben böyle hissediyorum” cümlesiyle geri dönün.";
      } else if (band === "degisken") {
        title = "Emek verilirse yürür, otomatik akmaz.";
        one = "Aranızda çekim var; fakat ilişki stabil kalmak için netlik ve uzlaşma ister.";
        two = `Şu an ilişkiyi taşıyan alan <b>${strongest.name}</b>; tıkandığınız yer ise <b>${weakest.name}</b>.`;
        three = "Yakınlaşıp uzaklaşma hissi olursa, sebep çoğu zaman beklenti ve iletişim tarzıdır.";
        scale = "Bu aralık “emek + uzlaşma” ile yükselen bir uyumu anlatır.";
        todayMove = "Bir konu büyümeden önce tek cümlelik check-in yapın: “Şu an bende kalan şu…”";
      } else if (band === "uyumlu") {
        title = "Uyum yüksek; birlikte büyüme potansiyeli var.";
        one = "Bu eşleşmede genel enerji destekleyici ve tatmin edici.";
        two = `En güçlü tarafınız <b>${strongest.name}</b>. Dikkat edilmesi gereken yer <b>${weakest.name}</b> tarafında birikme olmaması.`;
        three = "İyi giden ilişkiyi kalıcı yapan şey, küçük ama düzenli ortak alışkanlıklardır.";
        scale = "Bu aralık “doğal uyum” ve tatmin potansiyelini gösterir.";
        todayMove = "Haftalık 15 dakikalık “biz nasılız?” konuşması koyun, ilişkiyi çok sağlamlaştırır.";
      } else {
        title = "Çok güçlü çekim: aynı frekans hissi.";
        one = "Bağ hızlı derinleşebilir; “az konuşup çok anlama” hissi verebilir.";
        two = `Sizi en çok bir arada tutan alan <b>${strongest.name}</b>. Denge için <b>${weakest.name}</b> tarafını bilinçli beslemek iyi gelir.`;
        three = "Yüksek enerji bazen yoğunluk getirir; sağlıklı sınırlar ilişkiyi korur.";
        scale = "Bu aralık “çok yüksek çekim ve güçlü bağ” enerjisidir.";
        todayMove = "Birlikte ortak hedef belirleyin (mini plan): Bu bağın enerjisi planla daha da büyür.";
      }

      const namesLine = `<span class="h-sub"><b>${p1Name}</b> & <b>${p2Name}</b> için kısa yorum:</span>`;

      return {
        label,
        title,
        bodyHtml:
          `${namesLine}<br>${one}<br>${two}<br>${three}` +
          `<div class="h-sub">${scale}</div>` +
          `<div class="today-move">Bugün tek hamle: <span style="font-weight:800">${todayMove}</span></div>`
      };
    }

    function writeHumanCardHTML(insight){
      return `
        <div class="human-card">
          <div class="h-title">${insight.title} <span class="badge">${insight.label}</span></div>
          <div>${insight.bodyHtml}</div>
        </div>
      `;
    }

    function writeKapanisMesajiHTML() {
      const igLink = `<a class="ig-link" href="https://www.instagram.com/numerologsimurg/" target="_blank" rel="noopener noreferrer">@numerologsimurg</a>`;
      const html =
        `<b>Sevgili Simurg</b><br><br>` +
        `<div style="white-space:pre-line;">Detaylı numerolojik ilişki analizi için Instagram’dan bana mesaj bırak, birlikte bakalım.\n\nInstagram Hesabına Erişmek için Linke Tıklayın: ${igLink}</div>`;

      const div = document.getElementById("kapanis");
      div.innerHTML = html;
      div.style.display = "block";
    }

    function startAnalysis() {
      const person1Name = document.getElementById('person1Name').value;
      const person2Name = document.getElementById('person2Name').value;
      const person1DOB = document.getElementById('person1DOB').value;
      const person2DOB = document.getElementById('person2DOB').value;

      if (!person1Name || !person2Name || !person1DOB || !person2DOB) {
        alert('Lütfen her iki kişinin adı ve doğum tarihlerini giriniz.');
        return;
      }

      const person1NameNumber = calculateNameNumber(person1Name);
      const person2NameNumber = calculateNameNumber(person2Name);

      const person1VisiblePersonalityNumber = calculateVisiblePersonalityNumber(person1Name);
      const person2VisiblePersonalityNumber = calculateVisiblePersonalityNumber(person2Name);

      const person1LifeCode = calculateLifeCode(person1DOB);
      const person2LifeCode = calculateLifeCode(person2DOB);

      const person1Acquisition = calculateAcquisitionNumber(person1DOB);
      const person2Acquisition = calculateAcquisitionNumber(person2DOB);

      const person1BirthdayNumber = calculateBirthdayNumber(person1DOB);
      const person2BirthdayNumber = calculateBirthdayNumber(person2DOB);

      const person1SoulNumber = calculateSoulNumber(person1Name);
      const person2SoulNumber = calculateSoulNumber(person2Name);

      const Yasam = calculateYasamScore(person1LifeCode, person2LifeCode);
      const Edinim = calculateEdinimScore(person1Acquisition, person2Acquisition);
      const Dogum = calculateDogumScore(person1BirthdayNumber, person2BirthdayNumber);
      const Ruh = calculateRuhScore(person1SoulNumber, person2SoulNumber);
      const Gorunur = calculateGorunurScore(person1VisiblePersonalityNumber, person2VisiblePersonalityNumber);
      const Isim = calculateIsimScore(person1NameNumber, person2NameNumber);

      const iliskiPuani = Yasam + Edinim + Dogum + Ruh + Gorunur + Isim;
      const iliskiDurumu = getIliskiYorumu(iliskiPuani);

      const insight = buildHumanInsight({
        iliskiPuani,
        Yasam, Edinim, Dogum, Ruh, Gorunur, Isim,
        p1Name: person1Name,
        p2Name: person2Name
      });

      const outputHTML = `
        <div class="result-top">
          <div class="score">Uyum Yüzdesi: %${iliskiPuani}</div>
          <div class="pill">İlişki Durumu: ${iliskiDurumu} (%${iliskiPuani})</div>
        </div>

        ${writeHumanCardHTML(insight)}

        <div class="breakdown">
          <b>Yaşam:</b> ${Yasam} |
          <b>Edinim:</b> ${Edinim} |
          <b>Doğum:</b> ${Dogum} |
          <b>Ruh:</b> ${Ruh} |
          <b>Görünür:</b> ${Gorunur} |
          <b>İsim:</b> ${Isim}
        </div>
      `;

      const out = document.getElementById('output');
      out.innerHTML = outputHTML;
      out.style.display = 'block';

      writeKapanisMesajiHTML();
    }
  </script>
</body>
</html>